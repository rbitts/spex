<% 
layout('/layout') 

var insertMode = game_info === undefined;
<!--console.log(insertMode);-->
%>
    <div class="row wrapper border-bottom white-bg page-heading">
        <div class="col-lg-10">
            <h2><strong>내전정보</strong></h2>
            <ol class="breadcrumb">
                <li>
                    <a href="/league/dashboard">홈</a>
                </li>
                <li class="active">
                    <strong>내전기록</strong>
                </li>
            </ol>
        </div>
        <div class="col-lg-2">

        </div>
    </div>

    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox">
                    <div class="ibox-title">
                        <h5>경기입력</h5>
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-user">
                                <li><a href="#">Config option 1</a>
                                </li>
                                <li><a href="#">Config option 2</a>
                                </li>
                            </ul>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                    </div>
                    <div class="ibox-content">

                        <form class="form-horizontal m-t-md" action="/league/game_insert" method="POST">

                            <h3>경기일시</h3>
                            <div class="form-group">
                                <label class="col-sm-2 col-sm-2 control-label">경기일 *</label>
                                <div class="col-sm-10" id="data_1">
                                    <div class="input-group date">
                                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                        <input type="text" class="form-control required" name="game_date">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 col-sm-2 control-label">경기시간 *</label>
                                <div class="col-sm-10">
                                    <div class="input-group clockpicker" data-autoclose="true">
                                        <input type="text" class="form-control required" value="09:30" name="game_time" id="game_time">
                                        <span class="input-group-addon">
                                    <span class="fa fa-clock-o"></span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="hr-line-dashed"></div>
                            <div class="form-group">
                                <label class="col-sm-2 col-sm-2 control-label">블루팀</label>
                                <div class="col-sm-10">
                                    <select name="blue_team_id" data-placeholder="팀을 선택하세요" class="chosen-select" tabindex="1" value="1">
                                    <option value="">팀을 선택하세요</option>
                                    <% team_info.forEach(function(v,i){ %>
                                    <% if( !insertMode ) { %>
                                    <option value="<%=v.teamid%>" <%= v.teamid == game_info.blue_team_id ? 'selected' : '' %>><%=v.teamname%></option>
                                    <% } else {%>
                                    <option value="<%=v.teamid%>"><%=v.teamname%></option>
                                    <% }%>
                                    <% })%>
                                </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-2 col-sm-2 control-label">레드팀</label>
                                <div class="col-sm-10">
                                    <select name="red_team_id" data-placeholder="팀을 선택하세요" class="chosen-select" tabindex="1" value="1">
                                    <option value="">팀을 선택하세요</option>
                                    <% team_info.forEach(function(v,i){ %>
                                    <% if( !insertMode ) { %>
                                    <option value="<%=v.teamid%>" <%= v.teamid == game_info.red_team_id ? 'selected' : '' %>><%=v.teamname%></option>
                                    <% } else {%>
                                    <option value="<%=v.teamid%>"><%=v.teamname%></option>
                                    <% }%>
                                    <% })%>
                                </select>
                                </div>
                            </div>

                            <div class="hr-line-dashed"></div>
                            <% if( !insertMode ) { %>

                                <div class="form-group">
                                    <label class="col-sm-2 col-sm-2 control-label">승리팀</label>
                                    <div class="col-sm-10">
                                        <select name="won_team_id" data-placeholder="팀을 선택하세요" class="chosen-select" tabindex="1" value="1">
                                    <option value="">승리팀을 선택하세요</option>
                                    <% team_info.forEach(function(v,i){ %>
                                    <option value="<%=v.teamid%>" <%= v.teamid == game_info.won_team_id ? 'selected' : '' %>><%=v.teamname%></option>
                                    <% })%>
                                </select>
                                    </div>
                                </div>

                                <div class="hr-line-dashed"></div>
                                <div class="form-group">
                                    <label class="col-sm-2 col-sm-2 control-label">게임영상</label>
                                    <div class="col-sm-10">
                                        <input name="game_link" type="text" class="form-control" placeholder="" value="<%=game_info.game_link%>">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-sm-2 col-sm-2 control-label">하이라이트</label>
                                    <div class="col-sm-10">
                                        <input name="potg_link" type="text" class="form-control" placeholder="" value="<%=game_info.potg_link%>">
                                    </div>
                                </div>
                                <div class="hr-line-dashed"></div>
                                <input type="text" name="gid" class="form-control hidden" placeholder="" value="<%=gid%>">
                                <% } %>

                                    <div class="row">
                                        <div class="form-group m-b-lg">
                                            <div class="col-xs-5 col-xs-offset-1">
                                                <a href="javascript:history.go(-1)" class="btn btn-block btn-white">취소</a>
                                            </div>
                                            <div class="col-xs-5">
                                                <button class="btn btn-block btn-primary" type="submit">저장</button>
                                            </div>
                                        </div>
                                    </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        window.onload = function () {
            toggleStylesheet('/css/plugins/datapicker/datepicker3.css', 1);
            toggleStylesheet('/css/plugins/clockpicker/clockpicker.css', 1);
            toggleStylesheet('/css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css', 1);
            toggleStylesheet('/css/plugins/chosen/bootstrap-chosen.css', 1);

            $('head').append(' <script src = \'/js/plugins/chosen/chosen.jquery.js\'> <\/script>');
            $('head').append(' <script src = \'/js/plugins/datapicker/bootstrap-datepicker.js\'> <\/script>');
            $('head').append(' <script src = \'/js/plugins/clockpicker/clockpicker.js\'> <\/script>');

            $(document).ready(function () {

                var datepickerElmt = $('#data_1 .input-group.date').datepicker({
                    format: "yyyy-mm-dd",
                    todayBtn: "linked",
                    keyboardNavigation: false,
                    forceParse: false,
                    calendarWeeks: true,
                    autoclose: true
                });

                <% if(insertMode) { %>
                datepickerElmt.datepicker("setDate", new Date());
                <% } else { %>
                datepickerElmt.datepicker("setDate", '<%=game_info.date%>');
                $("#game_time").val('<%=game_info.time%>');
                <% }%>
                $('.clockpicker').clockpicker();

                $('.chosen-select').chosen({
                    width: "100%"
                });

            });


        }
    </script>